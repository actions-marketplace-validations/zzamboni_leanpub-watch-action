#+TITLE: Leanpub Watch Action

A GitHub Action to watch ongoing Leanpub builds.

* Inputs

- =api_key= (*required*): your Leanpub API key.
- =book_slug= (*required*): Your book slug. It's the part of the URL for your book after https://leanpub.com/. E.g. if your book is found at https://leanpub.com/your_book, then your book's slug is "your_book".

* Usage

You can use this in conjunction with the existing [[https://github.com/marketplace/actions/leanpub-preview-action][Leanpub Preview]] or [[https://github.com/marketplace/actions/leanpub-publish-action][Leanpub Publish]] actions, to watch over the triggered build. If there are any errors, this action will catch the backtrace generated by Leanpub and include it in the action log so you can examine it.

An example of triggering and watching a book preview after every change:

#+begin_src yaml
name: Build book preview on Leanpub
on: push

jobs:
  leanpub_preview:
    runs-on: ubuntu-latest
    steps:
      - name: Get repo name to use as book slug
        run: echo REPOSITORY_NAME=$(echo "$GITHUB_REPOSITORY" | awk -F / '{print $2}') >> $GITHUB_ENV
        shell: bash
      - name: Trigger Leanpub Preview
        uses: robert-matusewicz/leanpub-preview-action@v1.0
        with:
          api_key: ${{ secrets.LEANPUB_API_KEY }}
          book_slug: ${{ env.REPOSITORY_NAME }}
      - name: Monitor Leanpub build
        uses: zzamboni/leanpub-watch-action@v1
        with:
          api_key: ${{ secrets.LEANPUB_API_KEY }}
          book_slug: ${{ env.REPOSITORY_NAME }}
#+end_src
